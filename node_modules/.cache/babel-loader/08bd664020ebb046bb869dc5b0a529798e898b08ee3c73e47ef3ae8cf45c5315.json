{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.fCallArguments = exports.transformCommandReply = exports.transformLegacyCommandArguments = exports.transformCommandArguments = exports.attachExtensions = exports.attachCommands = void 0;\nconst command_options_1 = require(\"./command-options\");\nfunction attachCommands({\n  BaseClass,\n  commands,\n  executor\n}) {\n  for (const [name, command] of Object.entries(commands)) {\n    BaseClass.prototype[name] = function (...args) {\n      return executor.call(this, command, args, name);\n    };\n  }\n}\nexports.attachCommands = attachCommands;\nfunction attachExtensions(config) {\n  let Commander;\n  if (config.modules) {\n    Commander = attachWithNamespaces({\n      BaseClass: config.BaseClass,\n      namespaces: config.modules,\n      executor: config.modulesExecutor\n    });\n  }\n  if (config.functions) {\n    Commander = attachWithNamespaces({\n      BaseClass: Commander ?? config.BaseClass,\n      namespaces: config.functions,\n      executor: config.functionsExecutor\n    });\n  }\n  if (config.scripts) {\n    Commander ?? (Commander = class extends config.BaseClass {});\n    attachCommands({\n      BaseClass: Commander,\n      commands: config.scripts,\n      executor: config.scriptsExecutor\n    });\n  }\n  return Commander ?? config.BaseClass;\n}\nexports.attachExtensions = attachExtensions;\nfunction attachWithNamespaces({\n  BaseClass,\n  namespaces,\n  executor\n}) {\n  const Commander = class extends BaseClass {\n    constructor(...args) {\n      super(...args);\n      for (const namespace of Object.keys(namespaces)) {\n        this[namespace] = Object.create(this[namespace], {\n          self: {\n            value: this\n          }\n        });\n      }\n    }\n  };\n  for (const [namespace, commands] of Object.entries(namespaces)) {\n    Commander.prototype[namespace] = {};\n    for (const [name, command] of Object.entries(commands)) {\n      Commander.prototype[namespace][name] = function (...args) {\n        return executor.call(this.self, command, args, name);\n      };\n    }\n  }\n  return Commander;\n}\nfunction transformCommandArguments(command, args) {\n  let options;\n  if ((0, command_options_1.isCommandOptions)(args[0])) {\n    options = args[0];\n    args = args.slice(1);\n  }\n  return {\n    jsArgs: args,\n    args: command.transformArguments(...args),\n    options\n  };\n}\nexports.transformCommandArguments = transformCommandArguments;\nfunction transformLegacyCommandArguments(args) {\n  return args.flat().map(arg => {\n    return typeof arg === 'number' || arg instanceof Date ? arg.toString() : arg;\n  });\n}\nexports.transformLegacyCommandArguments = transformLegacyCommandArguments;\nfunction transformCommandReply(command, rawReply, preserved) {\n  if (!command.transformReply) {\n    return rawReply;\n  }\n  return command.transformReply(rawReply, preserved);\n}\nexports.transformCommandReply = transformCommandReply;\nfunction fCallArguments(name, fn, args) {\n  const actualArgs = [fn.IS_READ_ONLY ? 'FCALL_RO' : 'FCALL', name];\n  if (fn.NUMBER_OF_KEYS !== undefined) {\n    actualArgs.push(fn.NUMBER_OF_KEYS.toString());\n  }\n  actualArgs.push(...args);\n  return actualArgs;\n}\nexports.fCallArguments = fCallArguments;","map":{"version":3,"names":["Object","defineProperty","exports","value","fCallArguments","transformCommandReply","transformLegacyCommandArguments","transformCommandArguments","attachExtensions","attachCommands","command_options_1","require","BaseClass","commands","executor","name","command","entries","prototype","args","call","config","Commander","modules","attachWithNamespaces","namespaces","modulesExecutor","functions","functionsExecutor","scripts","scriptsExecutor","constructor","namespace","keys","create","self","options","isCommandOptions","slice","jsArgs","transformArguments","flat","map","arg","Date","toString","rawReply","preserved","transformReply","fn","actualArgs","IS_READ_ONLY","NUMBER_OF_KEYS","undefined","push"],"sources":["C:/rgraph/node_modules/@redis/client/dist/lib/commander.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.fCallArguments = exports.transformCommandReply = exports.transformLegacyCommandArguments = exports.transformCommandArguments = exports.attachExtensions = exports.attachCommands = void 0;\nconst command_options_1 = require(\"./command-options\");\nfunction attachCommands({ BaseClass, commands, executor }) {\n    for (const [name, command] of Object.entries(commands)) {\n        BaseClass.prototype[name] = function (...args) {\n            return executor.call(this, command, args, name);\n        };\n    }\n}\nexports.attachCommands = attachCommands;\nfunction attachExtensions(config) {\n    let Commander;\n    if (config.modules) {\n        Commander = attachWithNamespaces({\n            BaseClass: config.BaseClass,\n            namespaces: config.modules,\n            executor: config.modulesExecutor\n        });\n    }\n    if (config.functions) {\n        Commander = attachWithNamespaces({\n            BaseClass: Commander ?? config.BaseClass,\n            namespaces: config.functions,\n            executor: config.functionsExecutor\n        });\n    }\n    if (config.scripts) {\n        Commander ?? (Commander = class extends config.BaseClass {\n        });\n        attachCommands({\n            BaseClass: Commander,\n            commands: config.scripts,\n            executor: config.scriptsExecutor\n        });\n    }\n    return Commander ?? config.BaseClass;\n}\nexports.attachExtensions = attachExtensions;\nfunction attachWithNamespaces({ BaseClass, namespaces, executor }) {\n    const Commander = class extends BaseClass {\n        constructor(...args) {\n            super(...args);\n            for (const namespace of Object.keys(namespaces)) {\n                this[namespace] = Object.create(this[namespace], {\n                    self: {\n                        value: this\n                    }\n                });\n            }\n        }\n    };\n    for (const [namespace, commands] of Object.entries(namespaces)) {\n        Commander.prototype[namespace] = {};\n        for (const [name, command] of Object.entries(commands)) {\n            Commander.prototype[namespace][name] = function (...args) {\n                return executor.call(this.self, command, args, name);\n            };\n        }\n    }\n    return Commander;\n}\nfunction transformCommandArguments(command, args) {\n    let options;\n    if ((0, command_options_1.isCommandOptions)(args[0])) {\n        options = args[0];\n        args = args.slice(1);\n    }\n    return {\n        jsArgs: args,\n        args: command.transformArguments(...args),\n        options\n    };\n}\nexports.transformCommandArguments = transformCommandArguments;\nfunction transformLegacyCommandArguments(args) {\n    return args.flat().map(arg => {\n        return typeof arg === 'number' || arg instanceof Date ?\n            arg.toString() :\n            arg;\n    });\n}\nexports.transformLegacyCommandArguments = transformLegacyCommandArguments;\nfunction transformCommandReply(command, rawReply, preserved) {\n    if (!command.transformReply) {\n        return rawReply;\n    }\n    return command.transformReply(rawReply, preserved);\n}\nexports.transformCommandReply = transformCommandReply;\nfunction fCallArguments(name, fn, args) {\n    const actualArgs = [\n        fn.IS_READ_ONLY ? 'FCALL_RO' : 'FCALL',\n        name\n    ];\n    if (fn.NUMBER_OF_KEYS !== undefined) {\n        actualArgs.push(fn.NUMBER_OF_KEYS.toString());\n    }\n    actualArgs.push(...args);\n    return actualArgs;\n}\nexports.fCallArguments = fCallArguments;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}