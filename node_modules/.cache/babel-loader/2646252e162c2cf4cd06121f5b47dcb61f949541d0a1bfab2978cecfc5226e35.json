{"ast":null,"code":"\"use strict\";\n\nvar __classPrivateFieldSet = this && this.__classPrivateFieldSet || function (receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value), value;\n};\nvar __classPrivateFieldGet = this && this.__classPrivateFieldGet || function (receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _RedisClusterMultiCommand_multi, _RedisClusterMultiCommand_executor, _RedisClusterMultiCommand_firstKey;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst commands_1 = require(\"./commands\");\nconst multi_command_1 = require(\"../multi-command\");\nconst commander_1 = require(\"../commander\");\nconst _1 = require(\".\");\nclass RedisClusterMultiCommand {\n  static extend(extensions) {\n    return (0, commander_1.attachExtensions)({\n      BaseClass: RedisClusterMultiCommand,\n      modulesExecutor: RedisClusterMultiCommand.prototype.commandsExecutor,\n      modules: extensions?.modules,\n      functionsExecutor: RedisClusterMultiCommand.prototype.functionsExecutor,\n      functions: extensions?.functions,\n      scriptsExecutor: RedisClusterMultiCommand.prototype.scriptsExecutor,\n      scripts: extensions?.scripts\n    });\n  }\n  constructor(executor, firstKey) {\n    _RedisClusterMultiCommand_multi.set(this, new multi_command_1.default());\n    _RedisClusterMultiCommand_executor.set(this, void 0);\n    _RedisClusterMultiCommand_firstKey.set(this, void 0);\n    Object.defineProperty(this, \"EXEC\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: this.exec\n    });\n    __classPrivateFieldSet(this, _RedisClusterMultiCommand_executor, executor, \"f\");\n    __classPrivateFieldSet(this, _RedisClusterMultiCommand_firstKey, firstKey, \"f\");\n  }\n  commandsExecutor(command, args) {\n    const transformedArguments = command.transformArguments(...args);\n    __classPrivateFieldSet(this, _RedisClusterMultiCommand_firstKey, __classPrivateFieldGet(this, _RedisClusterMultiCommand_firstKey, \"f\") ?? _1.default.extractFirstKey(command, args, transformedArguments), \"f\");\n    return this.addCommand(undefined, transformedArguments, command.transformReply);\n  }\n  addCommand(firstKey, args, transformReply) {\n    __classPrivateFieldSet(this, _RedisClusterMultiCommand_firstKey, __classPrivateFieldGet(this, _RedisClusterMultiCommand_firstKey, \"f\") ?? firstKey, \"f\");\n    __classPrivateFieldGet(this, _RedisClusterMultiCommand_multi, \"f\").addCommand(args, transformReply);\n    return this;\n  }\n  functionsExecutor(fn, args, name) {\n    const transformedArguments = __classPrivateFieldGet(this, _RedisClusterMultiCommand_multi, \"f\").addFunction(name, fn, args);\n    __classPrivateFieldSet(this, _RedisClusterMultiCommand_firstKey, __classPrivateFieldGet(this, _RedisClusterMultiCommand_firstKey, \"f\") ?? _1.default.extractFirstKey(fn, args, transformedArguments), \"f\");\n    return this;\n  }\n  scriptsExecutor(script, args) {\n    const transformedArguments = __classPrivateFieldGet(this, _RedisClusterMultiCommand_multi, \"f\").addScript(script, args);\n    __classPrivateFieldSet(this, _RedisClusterMultiCommand_firstKey, __classPrivateFieldGet(this, _RedisClusterMultiCommand_firstKey, \"f\") ?? _1.default.extractFirstKey(script, args, transformedArguments), \"f\");\n    return this;\n  }\n  async exec(execAsPipeline = false) {\n    if (execAsPipeline) {\n      return this.execAsPipeline();\n    }\n    return __classPrivateFieldGet(this, _RedisClusterMultiCommand_multi, \"f\").handleExecReplies(await __classPrivateFieldGet(this, _RedisClusterMultiCommand_executor, \"f\").call(this, __classPrivateFieldGet(this, _RedisClusterMultiCommand_multi, \"f\").queue, __classPrivateFieldGet(this, _RedisClusterMultiCommand_firstKey, \"f\"), multi_command_1.default.generateChainId()));\n  }\n  async execAsPipeline() {\n    return __classPrivateFieldGet(this, _RedisClusterMultiCommand_multi, \"f\").transformReplies(await __classPrivateFieldGet(this, _RedisClusterMultiCommand_executor, \"f\").call(this, __classPrivateFieldGet(this, _RedisClusterMultiCommand_multi, \"f\").queue, __classPrivateFieldGet(this, _RedisClusterMultiCommand_firstKey, \"f\")));\n  }\n}\n_RedisClusterMultiCommand_multi = new WeakMap(), _RedisClusterMultiCommand_executor = new WeakMap(), _RedisClusterMultiCommand_firstKey = new WeakMap();\nexports.default = RedisClusterMultiCommand;\n(0, commander_1.attachCommands)({\n  BaseClass: RedisClusterMultiCommand,\n  commands: commands_1.default,\n  executor: RedisClusterMultiCommand.prototype.commandsExecutor\n});","map":{"version":3,"names":["__classPrivateFieldSet","receiver","state","value","kind","f","TypeError","has","call","set","__classPrivateFieldGet","get","_RedisClusterMultiCommand_multi","_RedisClusterMultiCommand_executor","_RedisClusterMultiCommand_firstKey","Object","defineProperty","exports","commands_1","require","multi_command_1","commander_1","_1","RedisClusterMultiCommand","extend","extensions","attachExtensions","BaseClass","modulesExecutor","prototype","commandsExecutor","modules","functionsExecutor","functions","scriptsExecutor","scripts","constructor","executor","firstKey","default","enumerable","configurable","writable","exec","command","args","transformedArguments","transformArguments","extractFirstKey","addCommand","undefined","transformReply","fn","name","addFunction","script","addScript","execAsPipeline","handleExecReplies","queue","generateChainId","transformReplies","WeakMap","attachCommands","commands"],"sources":["C:/rgraph/node_modules/@redis/client/dist/lib/cluster/multi-command.js"],"sourcesContent":["\"use strict\";\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _RedisClusterMultiCommand_multi, _RedisClusterMultiCommand_executor, _RedisClusterMultiCommand_firstKey;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst commands_1 = require(\"./commands\");\nconst multi_command_1 = require(\"../multi-command\");\nconst commander_1 = require(\"../commander\");\nconst _1 = require(\".\");\nclass RedisClusterMultiCommand {\n    static extend(extensions) {\n        return (0, commander_1.attachExtensions)({\n            BaseClass: RedisClusterMultiCommand,\n            modulesExecutor: RedisClusterMultiCommand.prototype.commandsExecutor,\n            modules: extensions?.modules,\n            functionsExecutor: RedisClusterMultiCommand.prototype.functionsExecutor,\n            functions: extensions?.functions,\n            scriptsExecutor: RedisClusterMultiCommand.prototype.scriptsExecutor,\n            scripts: extensions?.scripts\n        });\n    }\n    constructor(executor, firstKey) {\n        _RedisClusterMultiCommand_multi.set(this, new multi_command_1.default());\n        _RedisClusterMultiCommand_executor.set(this, void 0);\n        _RedisClusterMultiCommand_firstKey.set(this, void 0);\n        Object.defineProperty(this, \"EXEC\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: this.exec\n        });\n        __classPrivateFieldSet(this, _RedisClusterMultiCommand_executor, executor, \"f\");\n        __classPrivateFieldSet(this, _RedisClusterMultiCommand_firstKey, firstKey, \"f\");\n    }\n    commandsExecutor(command, args) {\n        const transformedArguments = command.transformArguments(...args);\n        __classPrivateFieldSet(this, _RedisClusterMultiCommand_firstKey, __classPrivateFieldGet(this, _RedisClusterMultiCommand_firstKey, \"f\") ?? _1.default.extractFirstKey(command, args, transformedArguments), \"f\");\n        return this.addCommand(undefined, transformedArguments, command.transformReply);\n    }\n    addCommand(firstKey, args, transformReply) {\n        __classPrivateFieldSet(this, _RedisClusterMultiCommand_firstKey, __classPrivateFieldGet(this, _RedisClusterMultiCommand_firstKey, \"f\") ?? firstKey, \"f\");\n        __classPrivateFieldGet(this, _RedisClusterMultiCommand_multi, \"f\").addCommand(args, transformReply);\n        return this;\n    }\n    functionsExecutor(fn, args, name) {\n        const transformedArguments = __classPrivateFieldGet(this, _RedisClusterMultiCommand_multi, \"f\").addFunction(name, fn, args);\n        __classPrivateFieldSet(this, _RedisClusterMultiCommand_firstKey, __classPrivateFieldGet(this, _RedisClusterMultiCommand_firstKey, \"f\") ?? _1.default.extractFirstKey(fn, args, transformedArguments), \"f\");\n        return this;\n    }\n    scriptsExecutor(script, args) {\n        const transformedArguments = __classPrivateFieldGet(this, _RedisClusterMultiCommand_multi, \"f\").addScript(script, args);\n        __classPrivateFieldSet(this, _RedisClusterMultiCommand_firstKey, __classPrivateFieldGet(this, _RedisClusterMultiCommand_firstKey, \"f\") ?? _1.default.extractFirstKey(script, args, transformedArguments), \"f\");\n        return this;\n    }\n    async exec(execAsPipeline = false) {\n        if (execAsPipeline) {\n            return this.execAsPipeline();\n        }\n        return __classPrivateFieldGet(this, _RedisClusterMultiCommand_multi, \"f\").handleExecReplies(await __classPrivateFieldGet(this, _RedisClusterMultiCommand_executor, \"f\").call(this, __classPrivateFieldGet(this, _RedisClusterMultiCommand_multi, \"f\").queue, __classPrivateFieldGet(this, _RedisClusterMultiCommand_firstKey, \"f\"), multi_command_1.default.generateChainId()));\n    }\n    async execAsPipeline() {\n        return __classPrivateFieldGet(this, _RedisClusterMultiCommand_multi, \"f\").transformReplies(await __classPrivateFieldGet(this, _RedisClusterMultiCommand_executor, \"f\").call(this, __classPrivateFieldGet(this, _RedisClusterMultiCommand_multi, \"f\").queue, __classPrivateFieldGet(this, _RedisClusterMultiCommand_firstKey, \"f\")));\n    }\n}\n_RedisClusterMultiCommand_multi = new WeakMap(), _RedisClusterMultiCommand_executor = new WeakMap(), _RedisClusterMultiCommand_firstKey = new WeakMap();\nexports.default = RedisClusterMultiCommand;\n(0, commander_1.attachCommands)({\n    BaseClass: RedisClusterMultiCommand,\n    commands: commands_1.default,\n    executor: RedisClusterMultiCommand.prototype.commandsExecutor\n});\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}