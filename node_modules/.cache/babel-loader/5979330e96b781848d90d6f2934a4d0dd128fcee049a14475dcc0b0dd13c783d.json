{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst stream_1 = require(\"stream\");\n/**\n * Convenient class to convert the process of scanning keys to a readable stream.\n */\nclass ScanStream extends stream_1.Readable {\n  constructor(opt) {\n    super(opt);\n    this.opt = opt;\n    this._redisCursor = \"0\";\n    this._redisDrained = false;\n  }\n  _read() {\n    if (this._redisDrained) {\n      this.push(null);\n      return;\n    }\n    const args = [this._redisCursor];\n    if (this.opt.key) {\n      args.unshift(this.opt.key);\n    }\n    if (this.opt.match) {\n      args.push(\"MATCH\", this.opt.match);\n    }\n    if (this.opt.type) {\n      args.push(\"TYPE\", this.opt.type);\n    }\n    if (this.opt.count) {\n      args.push(\"COUNT\", String(this.opt.count));\n    }\n    this.opt.redis[this.opt.command](args, (err, res) => {\n      if (err) {\n        this.emit(\"error\", err);\n        return;\n      }\n      this._redisCursor = res[0] instanceof Buffer ? res[0].toString() : res[0];\n      if (this._redisCursor === \"0\") {\n        this._redisDrained = true;\n      }\n      this.push(res[1]);\n    });\n  }\n  close() {\n    this._redisDrained = true;\n  }\n}\nexports.default = ScanStream;","map":{"version":3,"names":["Object","defineProperty","exports","value","stream_1","require","ScanStream","Readable","constructor","opt","_redisCursor","_redisDrained","_read","push","args","key","unshift","match","type","count","String","redis","command","err","res","emit","Buffer","toString","close","default"],"sources":["C:/rgraph/node_modules/ioredis/built/ScanStream.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst stream_1 = require(\"stream\");\n/**\n * Convenient class to convert the process of scanning keys to a readable stream.\n */\nclass ScanStream extends stream_1.Readable {\n    constructor(opt) {\n        super(opt);\n        this.opt = opt;\n        this._redisCursor = \"0\";\n        this._redisDrained = false;\n    }\n    _read() {\n        if (this._redisDrained) {\n            this.push(null);\n            return;\n        }\n        const args = [this._redisCursor];\n        if (this.opt.key) {\n            args.unshift(this.opt.key);\n        }\n        if (this.opt.match) {\n            args.push(\"MATCH\", this.opt.match);\n        }\n        if (this.opt.type) {\n            args.push(\"TYPE\", this.opt.type);\n        }\n        if (this.opt.count) {\n            args.push(\"COUNT\", String(this.opt.count));\n        }\n        this.opt.redis[this.opt.command](args, (err, res) => {\n            if (err) {\n                this.emit(\"error\", err);\n                return;\n            }\n            this._redisCursor = res[0] instanceof Buffer ? res[0].toString() : res[0];\n            if (this._redisCursor === \"0\") {\n                this._redisDrained = true;\n            }\n            this.push(res[1]);\n        });\n    }\n    close() {\n        this._redisDrained = true;\n    }\n}\nexports.default = ScanStream;\n"],"mappings":"AAAA,YAAY;;AACZA,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7D,MAAMC,QAAQ,GAAGC,OAAO,CAAC,QAAQ,CAAC;AAClC;AACA;AACA;AACA,MAAMC,UAAU,SAASF,QAAQ,CAACG,QAAQ,CAAC;EACvCC,WAAWA,CAACC,GAAG,EAAE;IACb,KAAK,CAACA,GAAG,CAAC;IACV,IAAI,CAACA,GAAG,GAAGA,GAAG;IACd,IAAI,CAACC,YAAY,GAAG,GAAG;IACvB,IAAI,CAACC,aAAa,GAAG,KAAK;EAC9B;EACAC,KAAKA,CAAA,EAAG;IACJ,IAAI,IAAI,CAACD,aAAa,EAAE;MACpB,IAAI,CAACE,IAAI,CAAC,IAAI,CAAC;MACf;IACJ;IACA,MAAMC,IAAI,GAAG,CAAC,IAAI,CAACJ,YAAY,CAAC;IAChC,IAAI,IAAI,CAACD,GAAG,CAACM,GAAG,EAAE;MACdD,IAAI,CAACE,OAAO,CAAC,IAAI,CAACP,GAAG,CAACM,GAAG,CAAC;IAC9B;IACA,IAAI,IAAI,CAACN,GAAG,CAACQ,KAAK,EAAE;MAChBH,IAAI,CAACD,IAAI,CAAC,OAAO,EAAE,IAAI,CAACJ,GAAG,CAACQ,KAAK,CAAC;IACtC;IACA,IAAI,IAAI,CAACR,GAAG,CAACS,IAAI,EAAE;MACfJ,IAAI,CAACD,IAAI,CAAC,MAAM,EAAE,IAAI,CAACJ,GAAG,CAACS,IAAI,CAAC;IACpC;IACA,IAAI,IAAI,CAACT,GAAG,CAACU,KAAK,EAAE;MAChBL,IAAI,CAACD,IAAI,CAAC,OAAO,EAAEO,MAAM,CAAC,IAAI,CAACX,GAAG,CAACU,KAAK,CAAC,CAAC;IAC9C;IACA,IAAI,CAACV,GAAG,CAACY,KAAK,CAAC,IAAI,CAACZ,GAAG,CAACa,OAAO,CAAC,CAACR,IAAI,EAAE,CAACS,GAAG,EAAEC,GAAG,KAAK;MACjD,IAAID,GAAG,EAAE;QACL,IAAI,CAACE,IAAI,CAAC,OAAO,EAAEF,GAAG,CAAC;QACvB;MACJ;MACA,IAAI,CAACb,YAAY,GAAGc,GAAG,CAAC,CAAC,CAAC,YAAYE,MAAM,GAAGF,GAAG,CAAC,CAAC,CAAC,CAACG,QAAQ,CAAC,CAAC,GAAGH,GAAG,CAAC,CAAC,CAAC;MACzE,IAAI,IAAI,CAACd,YAAY,KAAK,GAAG,EAAE;QAC3B,IAAI,CAACC,aAAa,GAAG,IAAI;MAC7B;MACA,IAAI,CAACE,IAAI,CAACW,GAAG,CAAC,CAAC,CAAC,CAAC;IACrB,CAAC,CAAC;EACN;EACAI,KAAKA,CAAA,EAAG;IACJ,IAAI,CAACjB,aAAa,GAAG,IAAI;EAC7B;AACJ;AACAT,OAAO,CAAC2B,OAAO,GAAGvB,UAAU","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}